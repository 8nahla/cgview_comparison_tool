<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">


  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="styles/stylesheet.css" type="text/css" />
    <title>CCT: Installation</title>
  </head>

  <body>

    <div id='banner'>
      <p id='banner-title'><span class='acronym'>C</span>GView <span class='acronym'>C</span>omparison <span class='acronym'>T</span>ool</p>
      <p id='banner-sub-title'><a href='https://sites.ualberta.ca/~stothard/'>Stothard Research Group</a></p>
    </div>

    <ul id='menu'>
      <li>
        <a href='index.html'>Overview</a>
      </li>
      <li>
        <a href='installation.html' id='selected'>Installation</a>
      </li>
      <li>
        <a href='creating_maps.html'>Creating Maps</a>
      </li>
      <li>
        <a href='commands.html'>Commands</a>
      </li>
      <li>
        <a href='tutorials.html'>Tutorials</a>
      </li>
      <li>
        <a href='customization_keys.html'>Customization Keys</a>
      </li>
    </ul>

    <div id='main'>
      <h1>CGView Comparison Tool (CCT) installation</h1>
      <fieldset id='contents'>
        <legend>Contents</legend>
        <ul>
          <li><a href="#requirements">Prerequisites for CCT installation</a></li>
          <li><a href="#macos">Installation on Mac OS X</a></li>
          <li><a href="#linux">Installation on Linux</a></li>
          <li><a href="#vm">CCT virtual machine</a></li>
        </ul>
      </fieldset>
      
      <h2 id="requirements">Prerequisites for CCT installation</h2>
      <ul>
        <li><a href="https://www.perl.org/">Perl 5.8.8 or newer</a></li>
        
        <li><a href="https://ftp.ncbi.nlm.nih.gov/blast/executables/legacy.NOTSUPPORTED/">Legacy blast-2.2.15 or newer</a></li>
        
        <li><a href="https://www.java.com/">Java (Java Runtime Environment) 1.4.2 or newer</a></li>
        
        <li><a href="https://www.imagemagick.org/">ImageMagick 6 or newer</a> (*Note: only required for the <a class='command' href='commands.html#build_blast_atlas_all_vs_all'>build_blast_atlas_all_vs_all.sh</a> command)</li>
        
        <li><a href="https://metacpan.org/search?query=bioperl&amp;mode=dist">BioPerl 1.4.0 (included)</a></li>
        
        <li><a href='https://github.com/kblin/merge-gbk-records'>merge-gbk-records</a></li>
        
      </ul>
      <p>
        Instructions for obtaining and installing these prerequisites and CCT are given below for Mac OS X and Linux. The instructions will likely need to be adjusted depending on the particular OS you are using, and as new versions of the perquisites are released. To use CCT on a Windows system we recommend using the CCT virtual machine (see the "<a href="#vm">CCT virtual machine</a>" section below). The virtual machine can also be used on Mac OS X and Linux systems. The advantage of using the virtual machine is that all the dependencies are already installed.
      </p>

      <h2 id="macos">Installation on Mac OS X</h2>

      <h3>Install Xcode</h3>
      
      <p>
        Use Finder or Spotlight to determine whether the Xcode application is already installed on your system. If Xcode has not been installed and you are using Mac OS X Snow Leopard, install Xcode from the Mac OS X install DVD (insert the DVD and choose Optional Installs and run the Xcode installer). If Xcode has not been installed and you are using MacOS X Lion or newer, install Xcode through the Mac App Store (open the Mac App Store, search for Xcode, and install the application). If you are installing Xcode version 4.1 or newer, ensure that the command-line tools are installed by doing the following: after Xcode installation is complete, search for Xcode using the Finder or Spotlight and click on the Xcode icon to launch Xcode. Choose Xcode->Preferences ... from the menu bar, click on the Downloads icon to open the Downloads preferences panel. Within this panel click the Components tab and select the Command Line Tools option and install it using the Check and Install Now button. For MacOS X Mavericks and later, the Downloads pane of Xcode Preferences does not support downloading command-line tools; therefore follow the instructions provided on this <a href="https://developer.apple.com/library/archive/technotes/tn2339/_index.html">technical note page</a> on Apple's website.  
      </p>
        
      <p>
        For more information about Xcode including download links and frequently asked questions visit the <a href="https://developer.apple.com/support/xcode/">support page</a> on Apple's website.
      </p>

      <p>
        The following CCT installation steps have been tested for Mac OS X 10.6.8 (Snow Leopard) with Xcode 3.2.6, for Mac OS X 10.7.3 (Lion) with Xcode 4.1 and for Mac OS X 10.11.6 (El Capitan) with Xcode 8.2.1.
      </p>
      
      <h3>Download CCT</h3>
      <ol>
        <li>
          <p>
            Download the <a href="https://sites.ualberta.ca/~stothard/downloads/cgview_comparison_tool.zip">CCT</a> package and unzip the file.
          </p>
        </li>
        <li>
          <p>
            Place the cgview_comparison_tool folder in a convenient location such as your home directory. Keep note of the location as it will be required when <a href='#mac-environment'>setting up your environment</a>.
          </p>
        </li>
      </ol>

      <h3>Install Homebrew</h3>

      <p>
        <a href="https://github.com/Homebrew/brew/">Homebrew</a> is a convenient way to install UNIX tools on Mac OS X systems. While Homebrew will be the method described here to install the required tools for CCT, it should also be possible to use other package management systems like <a href="https://www.macports.org/">MacPorts</a> and <a href="http://www.finkproject.org/">Fink</a>. Detailed instructions on how to install Homebrew can be found in this <a href="https://brew.sh/">page</a> but you should only need the following instruction to install it.
      </p>

      <p>
        To install <a href="http://mxcl.github.com/homebrew/">Homebrew</a>, launch the Terminal application (located in the <em class='file'>/Applications/Utilities</em> folder) and enter the following:
      </p>
      <pre class="code">
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</pre>

      <h3>Install ImageMagick</h3>

      <p>
        Enter the following command in the terminal:
      </p>
      <pre class='code'>
  brew install imagemagick</pre>
      
      <p>
        ImageMagick installation may take a while to complete.
      </p>

      <h3>Install Perl modules used by CCT</h3>
      <ol>
        <li>
          <p>
            In the terminal enter the following:
          </p>
          <pre class='code'>sudo perl -MCPAN -e shell</pre>
          <p>
            If you have not yet configured CPAN you will be prompted to do so.
          </p>
        </li>
        <li>
          <p>
            Enter the following configuration commands to automatically install module prerequisites:
          </p>
          <pre class='code'>
o conf prerequisites_policy follow
o conf commit</pre>
        </li>
        <li>
          <p>
            Install the required modules by entering these commands in the CPAN shell:
          </p>
          <pre class='code'>
install Error
install LWP::UserAgent
install LWP::Protocol::https
install Tie::IxHash
exit</pre>
        </li>
      </ol>

      <h3>Install BLAST</h3>

      <ol>
        <li>
          
          <p>
            Download legacy BLAST (<a href="https://ftp.ncbi.nlm.nih.gov/blast/executables/legacy.NOTSUPPORTED/2.2.26/">blast-2.2.26-universal-macosx.tar.gz</a> for example) from the NCBI <a href="https://ftp.ncbi.nlm.nih.gov/blast/executables/legacy.NOTSUPPORTED/">website</a>.
          </p>
          
        </li>
        <li>
          <p>
            In the terminal, change into the directory that the BLAST archive was downloaded into and enter the following to extract the files:
          </p>
          
          <pre class="code">tar xvzf blast-2.2.26-universal-macosx.tar.gz</pre>
          
          <p>
            Note: change the command as required to match the version of BLAST downloaded.
          </p>
        </li>
        <li>
          <p>
            Depending where the BLAST files were downloaded, you may want want to place them in a more convenient location. For example, to copy them to your home directory, the following command could be used:
          </p>
          
          <pre class="code">mv blast-2.2.26 ~</pre>
          
          <p>
            Note the location of the BLAST files, as it will be required when <a href='#mac-environment'>setting up your environment</a>.
          </p>
        </li>
      </ol>

      <h3>Install wget</h3>

      <p>
        Some CCT scripts use wget to retrieve information. Install wget with Homebrew:
      </p>

      <pre class='code'>
brew install wget</pre>

      <h3>Install merge-gbk-records</h3>

      <p>
        Installation instructions are available here <a href="https://github.com/kblin/merge-gbk-records">https://github.com/kblin/merge-gbk-records</a>:
      </p>

      <pre class='code'>
      pip install merge-gbk-records</pre>

      <h3 id='mac-environment'>Set up your environment</h3>
      <ol>
        <li>
          <p>
            In order to run properly, CCT requires some environmental variables to be set. The easiest way to do this is to edit your bash config file (<em class='file'>~/.bash_profile</em> or <em class='file'>~/.bashrc</em>). To open the config file, enter the following in the terminal:
          </p>
          <pre class='code'>open ~/.bash_profile</pre>
        </li>
        <li>
          <p>
            Add the following lines to the end of the config file, changing <em class='file'>/path/to/cgview_comparison_tool</em> and <em class='file'>/path/to/blast-2.2.26/bin</em> to the full path to the cgview_comparison_tool and BLAST directories.
          </p>
          <pre class='file-text'>
export CCT_HOME="<em>/path/to/cgview_comparison_tool</em>"
export PATH="$PATH":"${CCT_HOME}/scripts":<em>/path/to/blast-2.2.26/bin</em>
export PERL5LIB="${CCT_HOME}"/lib/bioperl-1.2.3:"${CCT_HOME}"/lib/perl_modules:"$PERL5LIB"</pre>
        </li>
        <li>
          <p>
            Save the file. Now the environment will be set the next time a terminal window is opened. To load the changes in an already open terminal enter this command:
          </p>
          <pre class='code'>source ~/.bash_profile</pre>
        </li>
      </ol>

      <h3>Test your setup</h3>
      <p>
        Launch the Terminal application and switch into the <em class='file'>cgview_comparison_tool</em> directory and run the following:
      </p>
      <pre class='code'>
  cd <em>/path/to/cgview_comparison_tool</em>
  ./update_cogs.sh
  ./test.sh</pre>
      <p>
        If the script is working you should see various progress messages as test maps are created. To stop the process, press Control-C.
      </p>
      
      <h2 id="linux">Installation on Linux</h2>

      <p>
        The following installation was performed on Ubuntu. Change them as needed for your distribution.
      </p>
      
      <h3>Download CCT</h3>
      <ol>
        <li>
          <p>
            Download the <a href="https://sites.ualberta.ca/~stothard/downloads/cgview_comparison_tool.zip">CCT</a> package and unzip the file.
          </p>
        </li>
        <li>
          <p>
            Place the <em class='file'>cgview_comparison_tool</em> folder in a convenient location such as your home directory. Keep note of the location as it will be required when <a href='#linux-environment'>setting up your environment</a>.
          </p>
        </li>
      </ol>

      <h3>Install Perl modules used by CCT</h3>
      <ol>
        <li>
          <p>
            Launch the Terminal application (location may vary depending on your linux distribution) and enter the following:
          </p>
          <pre class='code'>sudo perl -MCPAN -e shell</pre>
          <p>
            If you have not yet configured CPAN you will be prompted to do so.
          </p>
        </li>
        <li>
          <p>
            Enter the following configuration commands to automatically install module prerequisites:
          </p>
          <pre class='code'>
o conf prerequisites_policy follow
o conf commit</pre>
        </li>
        <li>
          <p>
            Install the required modules by entering these commands in the CPAN shell:
          </p>
          <pre class='code'>
install Error
install LWP::UserAgent
install LWP::Protocol::https
install Tie::IxHash
exit</pre>         
        </li>
      </ol>

      <h3>Install BLAST</h3>
      <ol>
        <li>
          <p>
            Download legacy BLAST (<a href="https://ftp.ncbi.nlm.nih.gov/blast/executables/legacy.NOTSUPPORTED/2.2.26/">blast-2.2.26-x64-linux.tar.gz</a> for example) from the NCBI <a href="https://ftp.ncbi.nlm.nih.gov/blast/executables/legacy.NOTSUPPORTED/">website</a>.
          </p>
        </li>
        <li>
          <p>
            In the terminal, change into the directory that the BLAST archive was downloaded into and enter the following to extract the files:
          </p>
            <pre class='code'>tar xvzf blast-2.2.26-x64-linux.tar.gz</pre>
          <p>
            Note: change the command as required to match the version of BLAST downloaded.
          </p>
        </li>
        <li>
          <p>
            Depending where the BLAST files were downloaded, you may want want to place them in a more convenient location. For example, to copy them to your home directory, the following command could be used:
          </p>
          <pre class="code">mv blast-2.2.26 ~</pre>
          <p>
            Note the location of the BLAST files, as it will be required when <a href='#linux-environment'>setting up your environment</a>.
          </p>
        </li>
      </ol>

      <h3>Install Java</h3>

      <p>
        CCT maps are drawn incorrectly by OpenJDK (the free and open-source implementation of the Java Platform Standard Edition), which is the default version of Java on some systems. Instead, install Java SE from Oracle (https://www.oracle.com/java/) and ensure that the Oracle version of Java is on your path by running the following command and confirming that the version is not OpenJDK:
      </p>
      <pre class="code">java -version</pre>

      <h3>Install ImageMagick</h3>
      <fieldset class='boxed-instructions'>
        <legend>Installation for Ubuntu</legend>
        <p>
          In the terminal enter the following:
        </p>
        <pre class='code'>
  sudo apt-get install imagemagick</pre>
      </fieldset>

      <p></p>
      <fieldset class='boxed-instructions'>
        <legend>Installation for other Linux distributions</legend>
        <p>
          Check the ImageMagick <a href="http://www.imagemagick.org/script/download.php">website</a>. If your distribution is listed, download the ImageMagick binary release and follow their provided instructions. Otherwise, you need to install it from source.
        </p>
      </fieldset>

      <p></p>
      <fieldset class='boxed-instructions'>
        <legend>Installation from source</legend>
        <ol>
          <li>
            <p>
              First install the PNG reference library:
            </p>
            <pre class='code'>
sudo apt-get install libpng12-0
sudo apt-get install libpng12-dev</pre>
            <p>
              The above command will verify and install these two libraries if needed.
            </p>
          </li>
          <li>
            <p>
              Download the ImageMagick <a href='http://www.imagemagick.org/download/ImageMagick.tar.gz'>source code</a>. A summary of the commands to install ImageMagick from source are shown below. A detailed explanation of each step is available on the ImageMagick website: <a href="http://www.imagemagick.org/script/install-source.php"><em>Install from Unix Source</em></a>
            </p>
            <pre class='code'>
cd ~
tar -xvzf ImageMagick.tar.gz
cd ImageMagick-7.0.6-1
./configure
make
sudo make install
sudo ldconfig /usr/local/lib</pre>
          </li>
        </ol>
      </fieldset>

      <h3>Install Geeqie</h3>

      <p>
        You can install Geeqie to visualize the images produced by CCT.
      </p>
      <p>
        In the terminal enter the following:
      </p>
      <pre class='code'>
  sudo apt-get install geeqie</pre>
  
      <h3>Install merge-gbk-records</h3>

      <p>
        Installation instructions are available here <a href="https://github.com/kblin/merge-gbk-records">https://github.com/kblin/merge-gbk-records</a>:
      </p>

      <pre class='code'>
      pip install merge-gbk-records</pre>


      <h3 id='linux-environment'>Set up your environment</h3>
      <ol>
        <li>
          <p>
            In order to run properly, CCT requires some environmental variables to be set. The easiest way to do this is to edit your bash config file
            (<em class='file'>~/.bashrc</em>). To open the config file, enter the following in the terminal:
          </p>
          <pre class='code'>
gedit ~/.bashrc</pre>
        </li>
        <li>
          <p>
            Add the following lines to the end of the config file, changing <em class='file'>/path/to/cgview_comparison_tool</em> and <em class='file'>          <!--/path/to/blast-2.2.25/bin</em> to the full path to the cgview_comparison_tool and BLAST directories.-->
            /path/to/blast-2.2.26/bin</em> to the full path to the cgview_comparison_tool and BLAST directories.
          </p>
          <pre class='file-text'>
export CCT_HOME="<em>/path/to/cgview_comparison_tool</em>"
export PATH="$PATH":"${CCT_HOME}/scripts":<em>/path/to/blast-2.2.26/bin</em>
export PERL5LIB="${CCT_HOME}"/lib/bioperl-1.2.3:"${CCT_HOME}"/lib/perl_modules:"$PERL5LIB"</pre>
        </li>
        <li>
          <p>
            Save the file. Now the environment will be set the next time a terminal window is opened. To load the changes in an already opened terminal enter this command:
          </p>
          <pre class='code'>
source ~/.bashrc</pre>
        </li>
      </ol>

      <h3>Test your setup</h3>
      <p>
        Launch the Terminal application and switch into the cgview_comparison_tool directory and run the following:
      </p>
      <pre class='code'>
  cd <em>/path/to/cgview_comparison_tool</em>
  ./update_cogs.sh
  ./test.sh</pre>
      <p>
        If the script is working you should see various progress messages as test maps are created. To stop the process, press Control-C.
      </p>

      <br></br><!--NOTE: Added a blank line.-->
      <h2 id="vm">CCT virtual machine</h2>
      <p>
        An alternative to downloading and installing the CCT prerequisites is to use a CCT virtual machine consisting of a Linux operating system with all the dependencies preinstalled. The CCT virtual machine runs in VirtualBox, which is freely available for Windows, Linux, Macintosh, and Solaris hosts.
      </p>

      <p>
        Depending on the virtualization product used to run the machine you may be able to drag and drop files from your host OS to the virtual machine. If this feature does not work you can easily transfer files using a USB drive.
      </p>

      <p>
        The CCT virtual machine has the following user account:
      </p>

      <pre class="file-text">
  user: ubuntu
  password: pw2016#</pre>

      <p>
        Numerous programs are included with this machine, including emacs and vim for viewing and editing text files, and xpdf for viewing pdf files.
      </p>

      <h3>Install VirtualBox Software</h3>
      <p>
        Before downloading the VirtualBox virtual machine, install the VirtualBox software on your computer. VirtualBox is available from <a href="http://www.virtualbox.org">http://www.virtualbox.org</a>. You may also need to install the "VirtualBox Extension Pack".
      </p>

      <h3>Download the CCT virtual machine:</h3>
        <p>
          Download the virtual machine from <a href="https://www.dropbox.com/s/eqaziptsb2kc9du/ubuntu-bioVM.ova?dl=0">here</a>.
        </p>

      <h3>Run the virtual machine:</h3>
      <ol>
        <li>
          <p>
            Launch VirtualBox and choose Import Appliance from the File menu.
          </p>
        </li>

        <li>
          <p>
            In the Appliance Import Wizard that opens use the Choose button to select the ubuntu-bioVM.ova file that was downloaded.
          </p>
        </li>

        <li>
          <p>
            Click Continue to view the virtual machine settings and click <em>Done/Import</em> to begin importing the virtual machine. This step may take a while to complete depending on your host.
          </p>
        </li>

        <li>
          <p>
            Select the newly imported virtual machine in the VM VirtualBox Manager and click <em>Start</em>.
          </p>
        </li>

        <li>
          <p>
            Log in to the virtual machine as user 'ubuntu' using the password 'pw2016#'.
          </p>
        </li>
      </ol>

      <h3 id='update-cct'>Update CCT and test your setup:</h3>
      <ol>
        <li>
          <p>
            Open the Terminal application by clicking on the Terminal icon, or by choosing Applications-&gt;Accessories-&gt;Terminal.
          </p>
        </li>

        <li>
          <p>
            Download and extract the latest version of CCT, and prepare the COG files used for COG assignment by entering the following in the terminal from the home directory:
          </p>
          <pre class="code">
./setup_CCT.sh</pre>
        </li>

        <li>
          <p>
            Navigate to the cgview_comparison_tool directory and run the <em class='file'>test.sh</em> script:
          </p>
          <pre class="code">
cd cgview_comparison_tool
./test.sh</pre>
        </li>
      </ol>

      <p>
        If the script is working you should see various progress messages as the maps are generated. To stop the test script, press Control-C.
      </p>

      <h3>Network troubleshooting</h3>

      <p>
        In case the scripts above in the <a href='#update-cct'>Update CCT and test your setup</a> section can't be executed, a network issue may be the cause. Please, try to solve these issues using the steps below.
      </p>

      <ol>
        <li>
          <p>
            Verify that your host OS has access to the internet and can access using a web browser or ping some internet addresses like the following:
          </p>
          <ul type="disc">
            <li>www.google.com</li>
            <li>www.amazon.com</li>
          </ul>
        </li>
        <li>
          <p>
            Do the same now inside the virtual machine.
          </p>
        </li>
        <li>
          <p>
            If some of the the addresses above cannot respond, check your firewall settings to see if your firewall is blocking in some way your access to sites located outside of your institution. You may need to talk to your Network Administrator.
          </p>
        </li>
        <li> 
          <p>
            In the VirtualBox Manager, select the virtual machine and click on the Settings icon in the toolbar. In the pop-up window that appears select Network. Verify that 'Enable Network Adapter' option is checked and 'Attached to:' combobox is set to NAT.
          </p>
        </li>

        <li>
          <p>
            If problems persist, <a href="https://forums.virtualbox.org/">virtualbox.org forums</a> provide specific answers for network problems for a variety of host operating systems, including <a href="https://forums.virtualbox.org/viewforum.php?f=6">Windows</a>, <a href="https://forums.virtualbox.org/viewforum.php?f=6">Linux</a> and <a href="https://forums.virtualbox.org/viewforum.php?f=8">Mac OS X</a>. In addition, there is a <a href="http://www.virtualbox.org/manual/ch12.html">Troubleshooting</a> section in the VirtualBox manual.
          </p>
        </li>

        <li>
          <p>
            You can also contact us by <a href="mailto:kommadat@ualberta.ca">email</a>. Please include your host OS information and the results you have obtained using the steps above.
          </p>
        </li>
      </ol>

    <br></br>

    </div>
  </body>
</html>
